#!/usr/bin/env wolframscript
(* ::Package:: *)

Needs["Quaternions`"]; 
quaternionToRotation[qq_]/;QuaternionQ[ToQuaternion[qq]]:=Module[{q=ToQuaternion[qq],aim,r},aim=AbsIJK[q];r=Re[q];
If[aim==0,Return[IdentityMatrix[3],Module]];
First[LinearAlgebra`Private`MatrixPolynomial[{Prepend[2 aim {r,aim}/(r^2+aim^2),1]},-LeviCivitaTensor[3,List].(Rest[List@@q]/aim)]]]


m=IdentityMatrix[4];
m[[1;;3,1;;3]]=EulerMatrix[{a,b,c},{1,2,3}];
m[[1;;3,-1]]={x,y,z};
transform[a_,b_,c_,x_,y_,z_]=TransformationFunction[m];


data = {{0.265300976`,-0.49199652671813965`,0.5051831603050232`,1.1956433057785034`,0.002282428555190563`,-0.5528860688209534`,0.8330106735229492`,0.020127663388848305`},{0.270308896`,-0.4920066297054291`,0.505121648311615`,1.1956517696380615`,0.0022880351170897484`,-0.5530357360839844`,0.8329112529754639`,0.0201257336884737`},{0.275766592`,-0.4919582009315491`,0.5050410628318787`,1.1956619024276733`,0.002054823562502861`,-0.5530960559844971`,0.8328706622123718`,0.020171688869595528`},{0.279842688`,-0.4919559359550476`,0.5049766898155212`,1.1956441402435303`,0.00194834906142205`,-0.5532170534133911`,0.8327904343605042`,0.020180821418762207`},{0.284956864`,-0.4919605553150177`,0.5049086809158325`,1.1956651210784912`,0.0017989565385505557`,-0.5533052682876587`,0.8327308297157288`,0.020235108211636543`},{0.289855296`,-0.4919247329235077`,0.5048490762710571`,1.1956194639205933`,0.0017676971619948745`,-0.5533042550086975`,0.8327282667160034`,0.020370015874505043`},{0.294692896`,-0.4919308125972748`,0.5047448873519897`,1.1956162452697754`,0.0016997926868498325`,-0.5533206462860107`,0.8327178955078125`,0.020358433946967125`},{0.30012768`,-0.4919329881668091`,0.5046864748001099`,1.195656418800354`,0.0016370584489777684`,-0.5533671379089355`,0.8326844573020935`,0.02046281471848488`},{0.304372512`,-0.49191954731941223`,0.5045850872993469`,1.1956133842468262`,0.0013946538092568517`,-0.5533601641654968`,0.8326858282089233`,0.020615270361304283`},{0.309276992`,-0.49212101101875305`,0.5046170949935913`,1.1957200765609741`,0.001494262833148241`,-0.5533931255340576`,0.8326646089553833`,0.020581042394042015`},{0.314048032`,-0.4918895363807678`,0.5043938755989075`,1.1956173181533813`,0.001271356944926083`,-0.5534141659736633`,0.832643985748291`,0.020860156044363976`},{0.318806208`,-0.49211156368255615`,0.5043988227844238`,1.1955372095108032`,0.0009393271175213158`,-0.552945077419281`,0.8329540491104126`,0.020939340814948082`},{0.32391264`,-0.49196958541870117`,0.5041818618774414`,1.1956305503845215`,0.0012738419463858008`,-0.5533749461174011`,0.832664430141449`,0.021081747487187386`},{0.329291904`,-0.49196645617485046`,0.5040485858917236`,1.1956459283828735`,0.0013534442987293005`,-0.5534381866455078`,0.832617998123169`,0.021250903606414795`},{0.333781504`,-0.4919590353965759`,0.5039297342300415`,1.1956454515457153`,0.0013485129456967115`,-0.5533998608589172`,0.8326420783996582`,0.02130715548992157`},{0.338203232`,-0.4920090436935425`,0.5037816166877747`,1.1956335306167603`,0.00150593020953238`,-0.553010106086731`,0.8329006433486938`,0.02131367288529873`},{0.343904512`,-0.4920671582221985`,0.5037485957145691`,1.195618748664856`,0.0011697583831846714`,-0.5531679391860962`,0.8327922821044922`,0.02146879956126213`},{0.348260832`,-0.4919780492782593`,0.5034964680671692`,1.1956431865692139`,0.0013018094468861818`,-0.5532822012901306`,0.832716703414917`,0.021451285108923912`},{0.352882208`,-0.49198001623153687`,0.5033063292503357`,1.1956669092178345`,0.0013272329233586788`,-0.553077220916748`,0.8328492045402527`,0.02159029245376587`},{0.357647232`,-0.492114394903183`,0.5031311511993408`,1.1956679821014404`,0.0013522463850677013`,-0.5529201030731201`,0.8329672813415527`,0.02105087600648403`},{0.362919744`,-0.49202635884284973`,0.503022313117981`,1.195670485496521`,0.001089356723241508`,-0.5530157685279846`,0.8328933119773865`,0.021473122760653496`},{0.36766672`,-0.4919300377368927`,0.5027621984481812`,1.1956983804702759`,0.0012173097347840667`,-0.5531229972839355`,0.832815408706665`,0.021727275103330612`},{0.37305024`,-0.49197474122047424`,0.50276118516922`,1.1956632137298584`,0.0008365674875676632`,-0.5530647039413452`,0.8328571319580078`,0.02163267508149147`},{0.377358464`,-0.4918888211250305`,0.5026193857192993`,1.1957318782806396`,0.0008790328865870833`,-0.5531243085861206`,0.832813024520874`,0.021802520379424095`},{0.38248448`,-0.491844117641449`,0.5024022459983826`,1.1957024335861206`,0.0009389016777276993`,-0.5532338619232178`,0.8327366709709167`,0.021933581680059433`},{0.387850176`,-0.4918486177921295`,0.5022910237312317`,1.1957288980484009`,0.0009362944401800632`,-0.553235650062561`,0.8327354192733765`,0.021932248026132584`},{0.392254496`,-0.4917801320552826`,0.502163827419281`,1.1956843137741089`,0.0007216917583718896`,-0.5531626343727112`,0.8327812552452087`,0.022043870761990547`},{0.397026272`,-0.4918172061443329`,0.502157986164093`,1.1956958770751953`,0.0009101905743591487`,-0.5531724095344543`,0.8327759504318237`,0.021992189809679985`},{0.401885024`,-0.49182480573654175`,0.5020440816879272`,1.1957006454467773`,0.0008325487724505365`,-0.5532333850860596`,0.832736611366272`,0.02195178158581257`},{0.406642816`,-0.4917484521865845`,0.5018035173416138`,1.1957085132598877`,0.0007842196500860155`,-0.553618848323822`,0.8324787616729736`,0.022016696631908417`},{0.411298016`,-0.4917798340320587`,0.5017992854118347`,1.1957437992095947`,0.0007975164335221052`,-0.5534449219703674`,0.8325992226600647`,0.021828709170222282`},{0.416395008`,-0.4917704164981842`,0.5017073154449463`,1.1957157850265503`,0.0006663448293693364`,-0.5534948706626892`,0.8325662016868591`,0.021832872182130814`},{0.421367776`,-0.4917300343513489`,0.5015835762023926`,1.195734977722168`,0.0006448436761274934`,-0.553535521030426`,0.8325375318527222`,0.021891813725233078`},{0.426608032`,-0.4917001724243164`,0.5014014840126038`,1.1957554817199707`,0.0008466555736958981`,-0.5537448525428772`,0.8323946595191956`,0.02202603407204151`},{0.430967168`,-0.4917455315589905`,0.5013682842254639`,1.195705771446228`,0.0008892486803233624`,-0.5535598993301392`,0.8325214982032776`,0.021879136562347412`},{0.43568272`,-0.49171870946884155`,0.501193106174469`,1.195738673210144`,0.0008113338844850659`,-0.5538768172264099`,0.8323095440864563`,0.02192353643476963`},{0.440507008`,-0.4916902780532837`,0.5010918974876404`,1.1957303285598755`,0.0007439853507094085`,-0.553790807723999`,0.8323655724525452`,0.021973878145217896`},{0.44550352`,-0.4917127192020416`,0.5010021924972534`,1.1957279443740845`,0.0008495904039591551`,-0.5538385510444641`,0.8323333263397217`,0.021987684071063995`},{0.450359072`,-0.4916858971118927`,0.5008932948112488`,1.195752501487732`,0.0006335478974506259`,-0.5539259314537048`,0.8322743773460388`,0.0220242440700531`},{0.455964448`,-0.4916594326496124`,0.500857412815094`,1.1958119869232178`,0.0007222436252050102`,-0.5537230372428894`,0.8324048519134521`,0.022197064012289047`},{0.460254752`,-0.49164989590644836`,0.500781238079071`,1.1957682371139526`,0.0006828252808190882`,-0.553794264793396`,0.8323578834533691`,0.0221785269677639`},{0.465044896`,-0.49163681268692017`,0.5006887316703796`,1.1958003044128418`,0.0006068797083571553`,-0.5537586212158203`,0.8323810696601868`,0.022201701998710632`},{0.47024816`,-0.49163416028022766`,0.5006027817726135`,1.195774793624878`,0.0005669834208674729`,-0.5537436604499817`,0.8323909640312195`,0.022204315289855003`},{0.475079264`,-0.4916742146015167`,0.5004878640174866`,1.195763111114502`,0.0007076136535033584`,-0.5541293025016785`,0.8321348428726196`,0.022181052714586258`},{0.479613152`,-0.4916265904903412`,0.5003892183303833`,1.1958096027374268`,0.0006436444818973541`,-0.5538859963417053`,0.8322983384132385`,0.02212524227797985`},{0.484483136`,-0.4915993809700012`,0.5002914071083069`,1.1958067417144775`,0.0005702676717191935`,-0.5537603497505188`,0.8323816061019897`,0.022137358784675598`},{0.489343008`,-0.49175000190734863`,0.5002458691596985`,1.1957411766052246`,0.0004944089450873435`,-0.5536496043205261`,0.8324638605117798`,0.021815508604049683`},{0.494193152`,-0.4916132390499115`,0.5001593828201294`,1.195831298828125`,0.0006362660205923021`,-0.5541439652442932`,0.8321279883384705`,0.02207273244857788`},{0.499272416`,-0.4916234612464905`,0.5000429749488831`,1.195818543434143`,0.0007645307341590524`,-0.5538539886474609`,0.8323213458061218`,0.022053439170122147`},{0.504318272`,-0.49155867099761963`,0.49992257356643677`,1.1958568096160889`,0.0007807764923200011`,-0.5540202260017395`,0.8322122693061829`,0.021991731598973274`},{0.509264928`,-0.49155163764953613`,0.499841570854187`,1.1958646774291992`,0.0007733107195235789`,-0.5540639758110046`,0.8321843147277832`,0.02194862812757492`},{0.513993824`,-0.49155187606811523`,0.4997248947620392`,1.1958590745925903`,0.0008007381111383438`,-0.5538653135299683`,0.8323183655738831`,0.021880129352211952`},{0.51864704`,-0.4915192425251007`,0.49961650371551514`,1.195883870124817`,0.0008068589959293604`,-0.5540507435798645`,0.8321961164474487`,0.021839024499058723`},{0.523472096`,-0.49154776334762573`,0.4995350241661072`,1.195911169052124`,0.0008577294647693634`,-0.5538085699081421`,0.8323583006858826`,0.021794317290186882`},{0.528792608`,-0.4915613830089569`,0.499420166015625`,1.1958736181259155`,0.0008641098393127322`,-0.5537387132644653`,0.8324059247970581`,0.021751465275883675`},{0.533286976`,-0.49151745438575745`,0.4992828965187073`,1.1958980560302734`,0.0008437425130978227`,-0.5538352727890015`,0.8323415517807007`,0.021757010370492935`},{0.538245248`,-0.4916728436946869`,0.49926435947418213`,1.1959402561187744`,0.0007519526407122612`,-0.5537706017494202`,0.8323890566825867`,0.02159005030989647`},{0.543382592`,-0.49144476652145386`,0.4989340007305145`,1.1959350109100342`,0.0007096200133673847`,-0.5540359020233154`,0.8322060704231262`,0.021837111562490463`},{0.548221824`,-0.49135875701904297`,0.49877455830574036`,1.1958470344543457`,0.0005996974068693817`,-0.5537542104721069`,0.8323909044265747`,0.021941950544714928`},{0.55271296`,-0.49144986271858215`,0.49878111481666565`,1.1959033012390137`,0.0009092447580769658`,-0.5540153384208679`,0.8322224617004395`,0.021724002435803413`},{0.557667648`,-0.49149709939956665`,0.49869516491889954`,1.19601309299469`,0.0011488932650536299`,-0.5538486242294312`,0.8323356509208679`,0.021627619862556458`},{0.56250624`,-0.4914216101169586`,0.49855148792266846`,1.1958949565887451`,0.0009585649822838604`,-0.5538268089294434`,0.8323493003845215`,0.02167186513543129`},{0.567437568`,-0.49133917689323425`,0.4983905851840973`,1.1959614753723145`,0.0010498636402189732`,-0.5539272427558899`,0.8322846293449402`,0.021587207913398743`},{0.572930432`,-0.4914700388908386`,0.4984031319618225`,1.195948839187622`,0.0010301896836608648`,-0.5537489652633667`,0.8324034214019775`,0.021582700312137604`},{0.577340736`,-0.49130913615226746`,0.4981520473957062`,1.195926547050476`,0.0011015137424692512`,-0.5539476275444031`,0.8322754502296448`,0.021408814936876297`},{0.581947456`,-0.49132901430130005`,0.49807584285736084`,1.1959213018417358`,0.0011239111190661788`,-0.5538058876991272`,0.8323736190795898`,0.02126450650393963`},{0.586870912`,-0.49124979972839355`,0.49795857071876526`,1.195915699005127`,0.0010983515530824661`,-0.5538744330406189`,0.8323296308517456`,0.021199427545070648`},{0.59200288`,-0.491228312253952`,0.49786171317100525`,1.1959218978881836`,0.001103899092413485`,-0.5538547039031982`,0.8323436975479126`,0.021161939948797226`},{0.596875136`,-0.49123677611351013`,0.4977608919143677`,1.1959205865859985`,0.0010344237089157104`,-0.5540614724159241`,0.8322098851203918`,0.021014677360653877`},{0.601572864`,-0.49123114347457886`,0.4976673424243927`,1.1959127187728882`,0.001072562183253467`,-0.5540627241134644`,0.8322098255157471`,0.02098330482840538`},{0.606336896`,-0.4912012815475464`,0.4975382685661316`,1.1959214210510254`,0.001065772376023233`,-0.5541449785232544`,0.8321564793586731`,0.020925017073750496`},{0.611316608`,-0.4911222755908966`,0.49727949500083923`,1.1958314180374146`,0.0007648735190741718`,-0.5539889335632324`,0.8322556614875793`,0.021126694977283478`},{0.616123328`,-0.49121561646461487`,0.49731576442718506`,1.195924997329712`,0.0010352774988859892`,-0.5541649460792542`,0.8321428894996643`,0.020938850939273834`},{0.621409984`,-0.49125462770462036`,0.4971933960914612`,1.1959470510482788`,0.0009548538946546614`,-0.5541418790817261`,0.8321552276611328`,0.021061109378933907`},{0.626078208`,-0.4912267327308655`,0.4970889985561371`,1.1959385871887207`,0.0009570061229169369`,-0.554166316986084`,0.8321380019187927`,0.021097272634506226`},{0.631230208`,-0.49135664105415344`,0.49709537625312805`,1.1959227323532104`,0.0007790052331984043`,-0.5542294979095459`,0.8320956826210022`,0.021117307245731354`},{0.635704512`,-0.4912348687648773`,0.49686184525489807`,1.1959505081176758`,0.0008953067590482533`,-0.5541136264801025`,0.8321682214736938`,0.021292956545948982`},{0.640501312`,-0.4912421405315399`,0.4967389404773712`,1.1959611177444458`,0.0008483661222271621`,-0.5541422367095947`,0.8321484327316284`,0.021323679015040398`},{0.64537664`,-0.49133047461509705`,0.4966801404953003`,1.195969820022583`,0.0008962524589151144`,-0.5542919635772705`,0.8320460915565491`,0.021428829059004784`},{0.650614912`,-0.4913010895252228`,0.4965200126171112`,1.195948600769043`,0.0008779821218922734`,-0.5542956590652466`,0.8320431709289551`,0.021445274353027344`},{0.655629696`,-0.49129214882850647`,0.49645131826400757`,1.1959742307662964`,0.0006120773614384234`,-0.5542317628860474`,0.8320825695991516`,0.021578848361968994`},{0.660468288`,-0.49122869968414307`,0.49623072147369385`,1.1960082054138184`,0.00067764992127195`,-0.5544310212135315`,0.8319507241249084`,0.021534457802772522`},{0.665335168`,-0.4912448525428772`,0.49611660838127136`,1.1959936618804932`,0.0006351295742206275`,-0.5545324683189392`,0.8318836688995361`,0.02151658944785595`},{0.669869696`,-0.4912896752357483`,0.4960007667541504`,1.1960023641586304`,0.0007658351678401232`,-0.5543904304504395`,0.8319758772850037`,0.021609926596283913`},{0.67471168`,-0.4913281798362732`,0.49596139788627625`,1.1960455179214478`,0.0005842786631546915`,-0.5546033978462219`,0.8318338990211487`,0.02161397598683834`},{0.679502912`,-0.49118563532829285`,0.4957192540168762`,1.1960135698318481`,0.0004998744698241353`,-0.5546721816062927`,0.8317877650260925`,0.021628323942422867`},{0.684460416`,-0.4912267029285431`,0.4956076145172119`,1.1960227489471436`,0.00044569472083821893`,-0.5546980500221252`,0.8317701816558838`,0.021644582971930504`},{0.689259136`,-0.4912118911743164`,0.4954774081707001`,1.1960229873657227`,0.0005715728620998561`,-0.5546837449073792`,0.8317808508872986`,0.021597540006041527`},{0.694467584`,-0.49120745062828064`,0.4953167736530304`,1.1960484981536865`,0.0005338111659511924`,-0.5547046661376953`,0.8317685723304749`,0.02152862213551998`},{0.699212608`,-0.49123671650886536`,0.49517694115638733`,1.1960371732711792`,0.0005403055693022907`,-0.5547932982444763`,0.8317090272903442`,0.02155103161931038`},{0.704281664`,-0.49120840430259705`,0.49505382776260376`,1.1960914134979248`,0.0005176094127818942`,-0.5546679496765137`,0.8317925930023193`,0.021548667922616005`},{0.70905568`,-0.49122971296310425`,0.49491533637046814`,1.1960809230804443`,0.0005299242329783738`,-0.5547042489051819`,0.8317689299583435`,0.02153128571808338`},{0.71372384`,-0.49119362235069275`,0.4947633743286133`,1.1960687637329102`,0.00043048406951129436`,-0.5547379851341248`,0.8317475914955139`,0.021482663229107857`},{0.71859712`,-0.4911543130874634`,0.4946349263191223`,1.196070909500122`,0.0003375300148036331`,-0.5545592904090881`,0.8318662643432617`,0.021506233140826225`},{0.72365888`,-0.4914502501487732`,0.4945645034313202`,1.1961809396743774`,0.0007394931162707508`,-0.5549969673156738`,0.8315766453742981`,0.02140505611896515`},{0.728563328`,-0.4911734461784363`,0.49434399604797363`,1.1961053609848022`,0.00046155526069924235`,-0.5542637705802917`,0.8320654034614563`,0.021419353783130646`},{0.733386368`,-0.49113306403160095`,0.4942305088043213`,1.1961103677749634`,0.0002021033433265984`,-0.5543484687805176`,0.8320075273513794`,0.021480655297636986`},{0.738293888`,-0.49131035804748535`,0.4940638244152069`,1.1960762739181519`,0.00007538510544691235`,-0.553935706615448`,0.8323017358779907`,0.02071557193994522`},{0.743119296`,-0.49113330245018005`,0.4939420521259308`,1.1961349248886108`,0.00024085833865683526`,-0.5539792776107788`,0.8322557210922241`,0.021383579820394516`},{0.74806464`,-0.4911338686943054`,0.49371737241744995`,1.196003794670105`,0.00010505838872632012`,-0.553422749042511`,0.8326409459114075`,0.020792357623577118`}}


qlist=Table[Quaternion[data[[i,5]],data[[i,6]],data[[i,7]],data[[i,8]]],{i,1,Length@data}];
ealist=Table[EulerAngles[quaternionToRotation[qlist[[i]]],{1,2,3}],{i,1,Length@qlist}];
